# 程式碼分析工具

一套專為開發團隊打造的程式碼分析工具，能夠針對指定的專案資料夾進行靜態分析，並整合 Git 版本控制資訊，幫助了解專案規模、複雜度與維護熱點。

## 功能特色

### 1. 程式碼分析
- 分析程式碼行數 (Lines of Code)
- 統計檔案數量
- 計算程式碼複雜度 (Cyclomatic Complexity)
- 識別最複雜的檔案和函數

### 2. Git Log 分析
- 讀取專案 Git 歷史記錄
- 統計各檔案異動次數
- 找出異動最頻繁的檔案
- 開發者活躍度時間軸分析

### 3. 作者品質評分系統 ⭐ **v2.4.2**
- **Commit 行為品質（40分）**：平均檔案數、最近活躍度、message品質
- **工作品質與範圍（30分）**：修改範圍廣度、程式碼變動規模、修改品質穩定性（5天內返工比例）
- **活躍度與影響力（30分）**：修改檔案總數、活躍時間跨度、專案貢獻比例
- **等級評定**：S/A/B/C/D 五級評分系統
- **詳細分析**：每位作者的完整品質報告和評分明細

### 4. 視覺化儀表板
- 直觀的圖表呈現分析結果
- 長條圖顯示複雜度分佈
- 圓餅圖顯示檔案異動頻率
- 開發者活躍度折線圖
- 作者品質評分表格與詳細彈出視窗

## 技術架構

- **程式語言**：Python 3.8+
- **後端框架**：FastAPI
- **程式碼分析**：Lizard
- **Git 分析**：GitPython
- **前端**：HTML5 + CSS3 + JavaScript + Chart.js

## 安裝步驟

### 1. 確認環境需求
確保已安裝 Python 3.8 或更高版本：
```bash
python --version
```

### 2. 安裝相依套件
```bash
pip install -r requirements.txt
```

## 使用方式

### 1. 啟動服務
```bash
python main.py
```

或使用 uvicorn：
```bash
uvicorn main:app --reload
```

### 2. 開啟瀏覽器
在瀏覽器中開啟：
```
http://localhost:8000
```

### 3. 分析專案
1. 在輸入框中輸入專案資料夾的完整路徑
   - Windows 範例：`C:\Projects\MyProject`
   - Linux/Mac 範例：`/home/user/projects/myproject`
2. 點擊「開始分析」按鈕
3. 等待分析完成，查看結果

## API 端點

### 分析程式碼
```http
POST /api/analyze/code
Content-Type: application/json

{
  "project_path": "/path/to/project"
}
```

### 分析 Git 歷史
```http
POST /api/analyze/git
Content-Type: application/json

{
  "project_path": "/path/to/project"
}
```

### 完整分析
```http
POST /api/analyze/all
Content-Type: application/json

{
  "project_path": "/path/to/project"
}
```

### 健康檢查
```http
GET /api/health
```

## 分析指標說明

### 程式碼複雜度 (Cyclomatic Complexity)
- **1-5**：低複雜度，程式碼簡單易懂
- **6-10**：中等複雜度，需要適度關注
- **11-20**：高複雜度，建議重構
- **>20**：極高複雜度，強烈建議重構

### 檔案異動頻率
- **低頻 (1-5次)**：較少修改的穩定檔案
- **中頻 (6-15次)**：正常維護的檔案
- **高頻 (16-30次)**：頻繁修改的檔案
- **極高頻 (>30次)**：維護熱點，可能需要重構

### 作者品質評分（v2.4.2）

#### 總分構成（100分）
1. **Commit 行為品質（40分）**
   - 平均每 commit 修改檔案數（20分）：1-3個檔案最佳
   - 最近活躍度（5分）：30天內有活動為佳
   - Commit message 品質（15分）：≥20字元為佳

2. **工作品質與範圍（30分）**
   - 修改範圍廣度（8分）：修改不同檔案數量
   - 程式碼變動規模（7分）：總插入+刪除行數
   - **修改品質穩定性（15分）**：⭐核心指標，5天內反覆修改同一檔案的比例
     - ≤10%：優秀品質（15分）
     - ≤20%：良好品質（12分）
     - ≤30%：普通品質（9分）
     - ≤50%：需改善（5分）
     - >50%：品質問題嚴重（2分）

3. **活躍度與影響力（30分）**
   - 修改檔案總數（10分）：≥50個為佳
   - 活躍時間跨度（10分）：≥180天為佳
   - 專案貢獻比例（10分）：≥30%為核心貢獻者

#### 等級評定
- **S級**：90-100分（卓越）
- **A級**：80-89分（優秀）
- **B級**：70-79分（良好）
- **C級**：60-69分（普通）
- **D級**：<60分（需改善）

#### 設計理念
- 針對**客製化專案**特性設計
- 透過「時間維度」區分品質問題 vs 需求變更
- 公平對待專精型工程師和廣度型工程師
- 鼓勵一次性完成、減少返工

## 效能特性

- 針對 10 萬行程式碼，可在 1 分鐘內產出分析結果
- 自動排除常見的無關資料夾（node_modules, venv, .git 等）
- 支援多種程式語言的分析

## 專案結構

```
AnalyzeProjectCode/
├── main.py                      # FastAPI 主程式
├── code_analyzer.py             # 程式碼分析模組
├── git_analyzer.py              # Git 分析模組
├── author_quality_scorer.py     # 作者品質評分模組（v2.4）
├── progress_tracker.py          # 進度追蹤模組（v2.2）
├── config_manager.py            # 設定管理模組
├── requirements.txt             # Python 相依套件
├── README.md                    # 使用說明
├── RFP.txt                      # 需求規格書
├── static/                      # 前端靜態檔案
│   ├── index.html               # 主頁面
│   ├── style.css                # 樣式表
│   └── script.js                # JavaScript 邏輯
├── user_config.json             # 使用者設定檔
└── .gitignore                   # Git 忽略檔案
```

## 注意事項

1. **Git 分析限制**：只有 Git 倉庫才能進行 Git 歷史分析，非 Git 專案只會顯示程式碼分析結果
2. **路徑格式**：Windows 使用者請使用完整路徑（如 `C:\Projects\MyProject`）
3. **權限問題**：確保程式有讀取目標專案資料夾的權限
4. **分析時間**：大型專案可能需要較長的分析時間，請耐心等候

## 版本歷程

- **v2.4.2** (2025-10-17)：評分維度重大調整（修改集中度 → 工作品質與範圍，加入時間維度）
- **v2.4.1** (2025-10-17)：評分算法調整（Commit行為品質維度優化）
- **v2.4** (2025-10-16)：作者品質評分系統
- **v2.3** (2025-10-16)：Git 分析作者指定過濾功能
- **v2.2** (2025-10-16)：即時進度追蹤功能
- **v2.1** (2025-10-15)：Bug 修正（排除檔案功能）
- **v2.0** (2025-10-15)：進階選項與開發者活躍度分析
- **v1.0**：基礎程式碼與 Git 分析功能

## 未來擴充方向

- [ ] 匯出分析報告（PDF/Excel）
- [ ] 歷史趨勢分析（跨多次分析比較）
- [ ] 支援多分支比較分析
- [ ] 程式碼重複度檢測
- [ ] 技術債務評估
- [ ] 團隊協作網路圖

## 授權

本專案僅供學習和內部使用。

## 問題回報

如遇到問題或有建議，請聯繫開發團隊。
